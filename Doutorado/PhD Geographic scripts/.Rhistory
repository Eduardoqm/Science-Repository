annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.2,
xend = c(8.5, 11.5, 15.5), yend = c(0.17, 0.17, 0.17),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.2, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.18, ymax = 0.16, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.2, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.18, ymax = 0.16, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.17, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.17, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.2, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.18, ymax = 0.16, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="GRND")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.21, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.2,
xend = c(8.5, 11.5, 15.5), yend = c(0.17, 0.17, 0.17),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.03, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.18, ymax = 0.16, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.2, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.18, ymax = 0.16, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.17, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.17, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.2, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.18, ymax = 0.16, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="GRND")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.21, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.2,
xend = c(8.5, 11.5, 15.5), yend = c(0.17, 0.17, 0.17),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.03, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.18, ymax = 0.16, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.03, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.18, ymax = 0.16, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.17, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.17, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.03, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.18, ymax = 0.16, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="GRND")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.21, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.2,
xend = c(8.5, 11.5, 15.5), yend = c(0.17, 0.17, 0.17),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.03, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.03, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.18, ymax = 0.16, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.17, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.17, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.03, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.18, ymax = 0.16, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="GRND")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.21, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.2,
xend = c(8.5, 11.5, 15.5), yend = c(0.17, 0.17, 0.17),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.03, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.03, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.17, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.17, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.03, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="GRND")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.21, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.2,
xend = c(8.5, 11.5, 15.5), yend = c(0.17, 0.17, 0.17),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.03, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.03, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.015, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.015, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.03, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="GRND")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.21, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.2,
xend = c(8.5, 11.5, 15.5), yend = c(0.17, 0.17, 0.17),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.03, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.03, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.014, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.014, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.03, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="GRND")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.21, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.2,
xend = c(8.5, 11.5, 15.5), yend = c(0.17, 0.17, 0.17),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.03, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.03, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.017, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.017, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.03, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
#NDWI ======================================================================================
list <- list.files(path="C:/Users/Eduardo Q Marques/Documents/My Jobs/Doutorado/Deposito/Banco de Dados Tanguro/Tanguro Indices/NDWI", pattern = ".tif$", full.names=TRUE,recursive=TRUE)
index <- stack(list)
#Extrair valor dos pixels
crtdf <- extract(index, crt)
b1yrdf <- extract(index, b1yr)
b3yrdf <- extract(index, b3yr)
a <- melt(crtdf)
colnames(a) = c('id', 'data', 'controle')
c <- melt(b1yrdf)
colnames(c) = c('id', 'data', 'b1yr')
b <- melt(b3yrdf)
colnames(b) = c('id', 'data', 'b3yr')
evi2 = as.data.frame(cbind(a, b, c))
evi2 <- evi2[,c(2, 3, 6, 9)]
evi2$data = substr(evi2$data, 18, 25)
#Median NDVI per year
evi2_md <- evi2
evi2_md$data = substr(evi2_md$data, 1, 4)
ndwi_md = evi2_md %>%
group_by(data) %>%
summarise(controle = median(controle),
b3yr = median(b3yr),
b1yr = median(b1yr))
gg <- melt(ndwi_md, id.vars="data")
colnames(gg) = c('Data', 'Parcela', 'Refl')
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="NDWI")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.21, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.2,
xend = c(8.5, 11.5, 15.5), yend = c(0.17, 0.17, 0.17),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.03, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.03, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.017, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.017, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.03, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="EVI")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 1.83, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 1.82,
xend = c(8.5, 11.5, 15.5), yend = c(1.75, 1.75, 1.75),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 1.45, label = "PrÃ©-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 1.37, ymax = 1.4, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 1.45, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 1.37, ymax = 1.4, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 1.39, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 1.39, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 1.45, label = "Periodo de recuperaÃ§Ã£o", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 1.37, ymax = 1.4, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="NDWI")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.21, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.2,
xend = c(8.5, 11.5, 15.5), yend = c(0.17, 0.17, 0.17),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.03, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.03, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.017, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.017, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.03, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="NDWI")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.6, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.55,
xend = c(8.5, 11.5, 15.5), yend = c(0.5, 0.5, 0.5),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.03, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.03, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.017, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.017, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.03, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="NDWI")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.6, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.55,
xend = c(8.5, 11.5, 15.5), yend = c(0.5, 0.5, 0.5),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.43, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.43, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.017, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.017, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.43, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="NDWI")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.6, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.55,
xend = c(8.5, 11.5, 15.5), yend = c(0.5, 0.5, 0.5),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.43, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.42, ymax = 0.41, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.43, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.017, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.017, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.43, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="NDWI")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.6, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.55,
xend = c(8.5, 11.5, 15.5), yend = c(0.5, 0.5, 0.5),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.43, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.41, ymax = 0.40, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.43, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.017, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.017, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.43, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.02, ymax = 0.01, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="NDWI")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.6, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.55,
xend = c(8.5, 11.5, 15.5), yend = c(0.5, 0.5, 0.5),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.43, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.41, ymax = 0.40, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.43, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.41, ymax = 0.40, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.017, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.017, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.43, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.41, ymax = 0.40, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="NDWI")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.6, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.55,
xend = c(8.5, 11.5, 15.5), yend = c(0.5, 0.5, 0.5),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.43, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.41, ymax = 0.40, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.43, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.41, ymax = 0.40, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.415, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.415, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.43, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.41, ymax = 0.40, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="NDWI")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.6, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.55,
xend = c(8.5, 11.5, 15.5), yend = c(0.5, 0.5, 0.5),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.43, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.41, ymax = 0.40, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.43, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.41, ymax = 0.40, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.415, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.415, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.43, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.42, ymax = 0.41, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="NDWI")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.6, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.55,
xend = c(8.5, 11.5, 15.5), yend = c(0.5, 0.5, 0.5),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.43, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.42, ymax = 0.41, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.43, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.42, ymax = 0.41, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.415, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.415, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.43, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.42, ymax = 0.41, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
ggplot(gg, aes(Data,Refl, col=Parcela))+
geom_line(aes(group=Parcela), size = 1)+
#geom_line(aes(group=Parcela), size = 1, linetype = "dashed")+
geom_point()+
#stat_smooth(aes(group=Parcela), method = "loess", formula = y ~ x, size = 0.5, alpha = 0.15)+
labs(fill= "Plot",x="Ano",y="NDWI")+
annotate("text", x = c(8.5, 11.5, 15.5), y = 0.6, label = "Seca")+
annotate("segment", x = c(8.5, 11.5, 15.5), y = 0.59,
xend = c(8.5, 11.5, 15.5), yend = c(0.57, 0.57, 0.57),
arrow = arrow(angle = 20, length = unit(2, "mm"), type = "closed"))+
annotate("text", x = 2.5, y = 0.43, label = "Pré-fogo", colour = "darkgreen")+
annotate("rect", xmin = 1, xmax = 5, ymin = 0.42, ymax = 0.41, alpha = 0.9, fill = "darkgreen")+
annotate("text", x = 8.5, y = 0.43, label = "Experimento de fogo", colour = "red")+
annotate("rect", xmin = 5, xmax = 12, ymin = 0.42, ymax = 0.41, alpha = 0.9, fill = "red")+
annotate("text", x = c(5.5, 8.5, 11.5), y = 0.415, label = "xx", colour = "yellow")+
annotate("text", x = c(6.5, 7.5, 10.5), y = 0.415, label = "x", colour = "yellow")+
annotate("text", x = 15.5, y = 0.43, label = "Periodo de recuperação", colour = "darkblue")+
annotate("rect", xmin = 12, xmax = 19, ymin = 0.42, ymax = 0.41, alpha = 0.9, fill = "darkblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 90))
#Beautiful maps to show in presentations
#Eduardo Q Marques 10/08/2019
library(raster)
library(rasterVis)
library(rgdal)
#Vectors
area1 = readOGR(dsn = "C:/Users/Eduardo Q Marques/Documents/My Jobs/Doutorado/Deposito/Banco de Dados Tanguro/shapes",layer="Area1big")
plots = readOGR(dsn = "C:/Users/Eduardo Q Marques/Documents/My Jobs/Doutorado/Deposito/Banco de Dados Tanguro/shapes",layer="Polygon_A_B_C")
#NDVI
a = stack(list.files(path="C:/Users/Eduardo Q Marques/Documents/My Jobs/Doutorado/Deposito/Banco de Dados Tanguro/Tanguro Indices/NDVI", pattern = ".tif$", full.names=TRUE,recursive=TRUE))
mapa = stack(a[[33]], a[[35]], a[[45]], a[[52]], a[[21]])
names(mapa) = c('2004', '2005', '2008', '2011', '2019')
#Transform vectors
area1 = spTransform(area1, crs(mapa))
plots = spTransform(plots, crs(mapa))
#Crop rasters
mapa = crop(mapa, area1)
b = levelplot(mapa[[1]], margin = FALSE, par.settings = RdBuTheme, main = "NDVI 2004")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[2]], margin = FALSE, par.settings = RdBuTheme, main = "NDVI 2005")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[3]], margin = FALSE, par.settings = RdBuTheme, main = "NDVI 2008")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[4]], margin = FALSE, par.settings = RdBuTheme, main = "NDVI 2011")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[5]], margin = FALSE, par.settings = RdBuTheme, main = "NDVI 2019")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
#EVI
a = stack(list.files(path="C:/Users/Eduardo Q Marques/Documents/My Jobs/Doutorado/Deposito/Banco de Dados Tanguro/Tanguro Indices/EVI2", pattern = ".tif$", full.names=TRUE,recursive=TRUE))
mapa = stack(a[[33]], a[[35]], a[[45]], a[[52]], a[[21]])
names(mapa) = c('2004', '2005', '2008', '2011', '2019')
#Crop rasters
mapa = crop(mapa, area1)
b = levelplot(mapa[[1]], margin = FALSE, par.settings = RdBuTheme, main = "EVI 2004")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[2]], margin = FALSE, par.settings = RdBuTheme, main = "EVI 2005")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[3]], margin = FALSE, par.settings = RdBuTheme, main = "EVI 2008")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[4]], margin = FALSE, par.settings = RdBuTheme, main = "EVI 2011")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[5]], margin = FALSE, par.settings = RdBuTheme, main = "EVI 2019")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
#NDMI
a = stack(list.files(path="C:/Users/Eduardo Q Marques/Documents/My Jobs/Doutorado/Deposito/Banco de Dados Tanguro/Tanguro Indices/NDMI", pattern = ".tif$", full.names=TRUE,recursive=TRUE))
mapa = stack(a[[33]], a[[35]], a[[45]], a[[52]], a[[21]])
names(mapa) = c('2004', '2005', '2008', '2011', '2019')
#Crop rasters
mapa = crop(mapa, area1)
b = levelplot(mapa[[1]], margin = FALSE, par.settings = RdBuTheme, main = "NDMI 2004")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[2]], margin = FALSE, par.settings = RdBuTheme, main = "NDMI 2005")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[3]], margin = FALSE, par.settings = RdBuTheme, main = "NDMI 2008")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[4]], margin = FALSE, par.settings = RdBuTheme, main = "NDMI 2011")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[5]], margin = FALSE, par.settings = RdBuTheme, main = "NDMI 2019")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
#GRND
a = stack(list.files(path="C:/Users/Eduardo Q Marques/Documents/My Jobs/Doutorado/Deposito/Banco de Dados Tanguro/Tanguro Indices/GRND", pattern = ".tif$", full.names=TRUE,recursive=TRUE))
mapa = stack(a[[33]], a[[35]], a[[45]], a[[52]], a[[21]])
names(mapa) = c('2004', '2005', '2008', '2011', '2019')
#Crop rasters
mapa = crop(mapa, area1)
b = levelplot(mapa[[1]], margin = FALSE, par.settings = RdBuTheme, main = "GRND 2004")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[2]], margin = FALSE, par.settings = RdBuTheme, main = "GRND 2005")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[3]], margin = FALSE, par.settings = RdBuTheme, main = "GRND 2008")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[4]], margin = FALSE, par.settings = RdBuTheme, main = "GRND 2011")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[5]], margin = FALSE, par.settings = RdBuTheme, main = "GRND 2019")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
#NDWI
a = stack(list.files(path="C:/Users/Eduardo Q Marques/Documents/My Jobs/Doutorado/Deposito/Banco de Dados Tanguro/Tanguro Indices/NDWI", pattern = ".tif$", full.names=TRUE,recursive=TRUE))
mapa = stack(a[[33]], a[[35]], a[[45]], a[[52]], a[[21]])
names(mapa) = c('2004', '2005', '2008', '2011', '2019')
#Crop rasters
mapa = crop(mapa, area1)
b = levelplot(mapa[[1]], margin = FALSE, par.settings = RdBuTheme, main = "NDWI 2004")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[2]], margin = FALSE, par.settings = RdBuTheme, main = "NDWI 2005")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[3]], margin = FALSE, par.settings = RdBuTheme, main = "NDWI 2008")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[4]], margin = FALSE, par.settings = RdBuTheme, main = "NDWI 2011")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa[[5]], margin = FALSE, par.settings = RdBuTheme, main = "NDWI 2019")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
b = levelplot(mapa, margin = FALSE, par.settings = RdBuTheme, main = "NDWI 2019")
b + layer(sp.lines(plots, lwd=2.0, col='black'))
